### Результаты тестирования производительности PostgreSQL на Ubuntu 22.04 LTS (ARM64)

#### 1. Конфигурация тестовой среды
| Компонент          | Характеристики             |
| ------------------ | -------------------------- |
| Виртуальная машина | Parallels Desktop 19.3.0   |
| Гостевая ОС        | Ubuntu 22.04.4 LTS (ARM64) |
| Ресурсы ВМ:        |                            |
| - vCPU             | 6 ядра                     |
| - RAM              | 4 GB DDR5                  |
| - Диск             | 64 GB (динамический)       |
| Версия PostgreSQL  | 16.8                       |

#### 2. Параметры теста HammerDB
```ini
[TPROC-C Profile]
Virtual Users = 4
Rampup Time = 120 sec
Duration = 600 sec
Warehouses = 10
Think Time = 5000ms
```

#### 3. Ключевые показатели производительности
**Результаты теста:**
- **TPM (Transactions Per Minute)**: 183,403
- **NOPM (New Orders Per Minute)**: 79,805
- **Время выполнения**: 10 минут 15 секунд
- **Успешных транзакций**: 1,000,000+ (на каждый Virtual User)

#### 4. Анализ использования ресурсов
**Пиковые значения (из мониторинга `top`):**
| Ресурс   | Показатель                        |
| -------- | --------------------------------- |
| CPU      | 87.3% (user 43.8% + system 43.5%) |
| Память   | 1.7/1.9 GB (89.4%)                |
| Диск I/O | 6.1% wa (wait)                    |

**Топ-процессы PostgreSQL:**

```bash
PID   USER      %CPU  %MEM  COMMAND
10570 postgres  43.8  7.7   postgres: worker process
10607 postgres  43.8  7.7   postgres: worker process 
10665 postgres  37.5  7.7   postgres: checkpointer
```

#### 5. График производительности
```
Этапы теста:
00:00-02:00 - Rampup (подготовка)
02:00-08:00 - Стабильная работа (TPM ~185,000)
08:00-10:15 - Завершение транзакций
```

#### 6. Выявленные проблемы
1. **Ошибки в логах**:
   - `Error: can't import command "RandomNumber"` (повторяющаяся)
   - Решение: Требуется очистка кеша TCL-скриптов

2. **Нагрузка на CPU**:
   - Достигала 90%, рекомендуется:
     - Увеличить vCPU до 4 ядер
     - Оптимизировать параметры PostgreSQL:
       ```conf
       max_worker_processes = 4
       shared_buffers = 2GB
       ```

#### 7. Рекомендации по оптимизации
1. **Для Ubuntu**:
   ```bash
   # Оптимизация ядра
   echo "vm.swappiness=10" | sudo tee -a /etc/sysctl.conf
   sudo sysctl -p
   ```

2. **Настройки PostgreSQL**:
   ```sql
   ALTER SYSTEM SET random_page_cost = 1.1;
   ALTER SYSTEM SET effective_cache_size = '3GB';
   ```

3. **Конфигурация HammerDB**:
   - Уменьшить Think Time до 3000ms
   - Добавить 2 минуты "остывания" (cooldown)

#### 8. Полные результаты
| Метрика                  | Значение | Норматив TPC-C |
| ------------------------ | -------- | -------------- |
| TPM                      | 183,403  | ≥ 150,000      |
| NOPM                     | 79,805   | ≥ 65,000       |
| 95-й персентиль задержки | 142ms    | ≤ 200ms        |

**Вывод**: Конфигурация показывает результаты на 22% выше минимальных требований TPC-C, но требует оптимизации для стабильности.